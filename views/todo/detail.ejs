<%- include("../common/header") %>

<div class="col-xs-12 col-sm-12 col-md-10 ">
  <div class="content-box-large">

    <div class="row">
      <div class="col-sm-4 col-md-4 col-lg-4 col-xl-4">
        <p><label class="control-label ">タスクID</label></p>
        <p><input class="form-control" type="text" disabled="disabled" value="<%- task.id %>"></p>
      </div>
      <!-- 作成日時及び更新日時-->
      <div class="col-sm-4 col-md-4 col-lg-4 col-xl-4">
        <p>作成日時</p>
        <p><input type="text" disabled="disabled" class="form-control" value="<%- task.formatted_created_at() %>"></p>
      </div>
      <div class="col-sm-4 col-md-4 col-lg-4 col-xl-4">
        <p>更新日時</p>
        <p><input type="text" disabled="disabled" class="form-control" value="<%- task.formatted_updated_at() %>"></p>
      </div>
    </div>


    <div class="row ">
      <div class="col-sm-6 col-md-6 col-lg-6 col-xl-6">
        <p>タスク名</p>
        <p><%- task.task_name %></p>
      </div>

      <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3 ">
        <p>作業者IDおよび作業者名</p>
        <p>(<%- task.user_id %>) <%- task.user.user_name %></p>
      </div>

      <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3 ">
        <p>タスクステータス</p>
        <p><%- taskStatusNameList[task.status] %></p>
      </div>
    </div>

    <div class="row ">
      <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3 ">
        <p>紐づくプロジェクト</p>
        <p><%- task.Project.project_name %></p>
      </div>

      <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3 ">
        <p>優先度の設定</p>
        <p><%- priorityNameList[task.priority] %></p>
      </div>
    </div>

    <div class="row ">
      <div class="col-sm-6 col-md-6 col-lg-6 col-xl-6 ">
        <p>タスク詳細</p>
        <p><%- task.task_description %></p>
      </div>
    </div>
  </div>

  <div class="content-box-large">
    <div class="row">
      <form method="POST" action="/todo/comment/<%- task.id %>" accept-charset="UTF-8" class="form-group">
        <input type="hidden" name="task_id" value="<%- task.id %>">
        <input type="hidden" name="user_id" value="2">
        <div class="row ">
          <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12">
            <p>コメント内容</p>
            <p>
              <textarea class="form-control" id="task_description" placeholder="注意事項がある場合は入力のこと" name="comment" cols="50 " rows="10 "></textarea>
            </p>
          </div>
          <% if (sessionErrors.comment) { %>
          <!-- エラーメッセージ -->
          <div class="col-md-12 col-lg-12 col-xl-12 ">
            <p class="alert alert-danger "><%- sessionErrors.comment %></p>
          </div>
          <!-- エラーメッセージ -->
          <% } %>
        </div>

        <div class="row">
          <div class="col-sm-6 col-md-6 col-lg-6 col-xl-6">
            <p>上記内容で店舗更新をする</p>
            <p><button class="btn btn-outline-primary" type="submit" >コメントする</button></p>
          </div>
        </div>
      </form>
    </div>

    <!-- 投稿されたコメント群 -->
    <div class="row">
      <% task.TaskComments.forEach((taskComment, index) => { %>
        <div class="col-md-3 col-lg-3 col-xl-3">
          <p class="form-control">コメントID:<%- taskComment.id %></p>
          <p class="form-control"><%- taskComment.user.user_name %></p>
          <p class="form-control">
            <%- taskComment.formatted_created_at() %><br>
            <%- taskComment.formatted_updated_at() %>
          </p>
        </div>
        <div class="col-md-9 col-lg-9 col-xl-9">
          <p class="form-control"><%- taskComment.get_new_line_comment() %></p>
        </div>
      <% }) %>
    </div>
  </div>
</div>


<%- include("../common/footer") %>